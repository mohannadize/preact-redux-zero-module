"use strict";import*as preact from"./preact.js";var __assign=function(){return(__assign=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function createStore$1(t,n){void 0===t&&(t={}),void 0===n&&(n=null);var e=t||{},r=[];function o(){r.forEach(function(t){return t(e)})}return{middleware:n,setState:function(t){e=__assign({},e,"function"==typeof t?t(e):t),o()},subscribe:function(t){return r.push(t),function(){r.splice(r.indexOf(t),1)}},getState:function(){return e},reset:function(){e=t,o()}}}export default createStore$1;var extendStatics=function(t,n){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)};function __extends(t,n){function e(){this.constructor=t}extendStatics(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}__assign=function(){return(__assign=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};function shallowEqual(t,n){for(var e in t)if(t[e]!==n[e])return!1;for(var e in n)if(!(e in t))return!1;return!0}function set(t,n){if(null!=n){if(n.then)return n.then(t.setState);t.setState(n)}}function bindAction(t,n){return function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return"function"==typeof n.middleware?n.middleware(n,t,e):set(n,t.apply(void 0,[n.getState()].concat(e)))}}function bindActions(t,n,e){t="function"==typeof t?t(n,e):t;var r={};for(var o in t){var i=t[o];r[o]=bindAction(i,n)}return r}export var Connect=function(t){function n(n,e){var r=t.call(this,n,e)||this;return r.update=function(){var t=r.getProps(r.props,r.context);shallowEqual(t,r.state)||r.setState(t)},r.state=r.getProps(n,e),r.actions=r.getActions(),r}return __extends(n,t),n.prototype.componentWillMount=function(){this.unsubscribe=this.context.store.subscribe(this.update)},n.prototype.componentWillUnmount=function(){this.unsubscribe(this.update)},n.prototype.componentWillReceiveProps=function(t,n){var e=this.getProps(t,n);shallowEqual(e,this.state)||this.setState(e)},n.prototype.getProps=function(t,n){var e=t.mapToProps,r=n.store&&n.store.getState()||{};return e?e(r,t):r},n.prototype.getActions=function(){return bindActions(this.props.actions,this.context.store,this.props)},n.prototype.render=function(t,n,e){var r=t.children,o=e.store;return(r&&r[0]||r)(__assign({store:o},n,this.actions))},n}(preact.Component);var ConnectUntyped=Connect;export function connect(t,n){return void 0===n&&(n={}),function(e){return function(r){function o(){return null!==r&&r.apply(this,arguments)||this}return __extends(o,r),o.prototype.render=function(){var r=this.props;return preact.h(ConnectUntyped,__assign({},r,{mapToProps:t,actions:n}),function(t){return preact.h(e,__assign({},t,r))})},o}(preact.Component)}}export var Provider=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return __extends(n,t),n.prototype.getChildContext=function(){return{store:this.props.store}},n.prototype.render=function(){return this.props.children&&this.props.children[0]||this.props.children},n}(preact.Component);